<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Friendzone - Sammy</title><meta name="Description" content="write up for friendzone on HackTheBox a rank easy linux box."><meta property="og:title" content="Friendzone" />
<meta property="og:description" content="write up for friendzone on HackTheBox a rank easy linux box." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/friendzone/" />
<meta property="og:image" content="https://example.com/logo.png"/>
<meta property="article:published_time" content="2019-07-11T11:20:31+01:00" />
<meta property="article:modified_time" content="2020-06-26T18:29:03+03:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://example.com/logo.png"/>

<meta name="twitter:title" content="Friendzone"/>
<meta name="twitter:description" content="write up for friendzone on HackTheBox a rank easy linux box."/>
<meta name="application-name" content="Sammy">
<meta name="apple-mobile-web-app-title" content="Sammy"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://example.com/friendzone/" /><link rel="prev" href="https://example.com/hello-world/" /><link rel="next" href="https://example.com/hashcat-gen-passwords/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Friendzone",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/example.com\/friendzone\/"
        },"image": ["https:\/\/example.com\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "HackTheBox","wordcount":  822 ,
        "url": "https:\/\/example.com\/friendzone\/","datePublished": "2019-07-11T11:20:31+01:00","dateModified": "2020-06-26T18:29:03+03:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/example.com\/images\/avatar.png",
                    "width":  746 ,
                    "height":  747 
                }},"author": {
                "@type": "Person",
                "name": "Sammy"
            },"description": "write up for friendzone on HackTheBox a rank easy linux box."
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Sammy"><span class="header-title-pre"><i class='fas fa-terminal fa-fw'></i></span>cd home</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/projects"> Projects </a><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="https://github.com/Sam-Lane" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Sammy"><span class="header-title-pre"><i class='fas fa-terminal fa-fw'></i></span>cd home</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/projects" title="">Projects</a><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="https://github.com/Sam-Lane" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Friendzone</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Sammy</a></span>&nbsp;<span class="post-category">included in <a href="/categories/hacking/"><i class="far fa-folder fa-fw"></i>hacking</a>&nbsp;<a href="/categories/writeup/"><i class="far fa-folder fa-fw"></i>writeup</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2019-07-11">2019-07-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;822 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#looking-into-the-samba-share">Looking into the samba share.</a></li>
        <li><a href="#the-website">The Website</a></li>
        <li><a href="#digging-through-dns">Digging through DNS.</a></li>
      </ul>
    </li>
    <li><a href="#exploiting-the-lfi">Exploiting the LFI.</a></li>
    <li><a href="#heading"></a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="htb-writeup-friendzone">HTB Writeup: friendzone</h1>
<h2 id="introduction">Introduction</h2>
<p>Friendzone was my third box to own on HackTheBox. I learnt <strong>alot</strong> from this box. Such as exploiting Local File Inclusion (LFI) to have PHP execute my reverse shell, to understanding more about DNS and the ways python imports libraries.</p>
<h2 id="enumeration">Enumeration</h2>
<h3 id="nmap">nmap</h3>
<p>Running nmap on a server will give a lot of information on what ports are open on the machine and what services those ports belong to.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">nmap -sS -sC -sV -oA friendzone -p- -T4 10.10.10.123
</code></pre></td></tr></table>
</div>
</div><p>From running the above command we see the following services and ports running on friendzone.</p>
<ul>
<li>ftp 21</li>
<li>ssh 22</li>
<li>domain 53</li>
<li>http 80</li>
<li>samba 139</li>
<li>https 443</li>
<li>samba 445</li>
</ul>
<h3 id="looking-into-the-samba-share">Looking into the samba share.</h3>
<p>Kali comes with a great tool smbmap for doing recon on samba shares.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">smbmap -H 10.10.10.123
</code></pre></td></tr></table>
</div>
</div><p>Running it we get this result.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">root@kali:~# smbmap -H 10.10.10.123
<span class="o">[</span>+<span class="o">]</span> Finding open SMB ports....
<span class="o">[</span>+<span class="o">]</span> Guest SMB session established on 10.10.10.123...
<span class="o">[</span>+<span class="o">]</span> IP: 10.10.10.123:445	Name: administrator1.friendzone.red                     
	Disk                                                  	Permissions
	----                                                  	-----------
	print$                                            	NO ACCESS
	Files                                             	NO ACCESS
	general                                           	READ ONLY
	Development                                       	READ, WRITE
	IPC$ 

</code></pre></td></tr></table>
</div>
</div><p>This tells use we have read only access to general and can read and write to Development. Lets start of by seeing what can be found in general. To do this I used smbclient on kali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">smbclient //10.10.10.123/general
</code></pre></td></tr></table>
</div>
</div><p>When prompted for a password you can just hit enter and get a smb shell. Hitting <code>ls</code> there is a file called creds.txt lets grab that with <code>get creds.txt</code> putting it onto the local machine and using cat to read it we get:</p>
<blockquote>
<p>creds for the admin THING:</p>
<p>admin:WORKWORKHhallelujah@#</p>
</blockquote>
<p>Lets have a quick look into Development using the same smbclient command as before and see if there is anything interesting. It just contains rubbish but lets remember for the future we can write to this directory and that can be incredible useful for exploitation.</p>
<h3 id="the-website">The Website</h3>
<p>So we have admin credential that do not work for ssh so maybe the website contains. I used dirb which is a peice of software that takes a list of common urls and trys them against a target. Dirb proved to not find anything other than a mocking robots.txt and an index page:</p>
<figure>
    <img src="/img/friendzonewebsite.png"
         alt="friendzone website"/> <figcaption>
            <p>/index.html</p>
        </figcaption>
</figure>

<p>That is when I remembered the server was running a DNS service&hellip;</p>
<h3 id="digging-through-dns">Digging through DNS.</h3>
<p>DNS is the service that resolves a human readable website url such as <a href="http://www.google.com">www.google.com</a> to an ip address. Thanks to <cite>ippsec<a href="https://youtu.be/JRPWFSzFaG0?t=75" target="_blank" rel="noopener noreffer">1</a></cite> video were he uses a range of tools to enumerate DNS. The only command he used that was any use was dig. Running:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">dig axfr friendzoneportal.red @10.10.10.123
</code></pre></td></tr></table>
</div>
</div><p>Getting the domain friendzoneportal.red from the home page email address returns:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">root@kali:~/HTB/FriendZone# dig axfr friendzoneportal.red @10.10.10.123

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG 9.11.5-P4-3-Debian &lt;&lt;&gt;&gt; axfr friendzoneportal.red @10.10.10.123
<span class="p">;;</span> global options: +cmd
friendzoneportal.red.	604800	IN	SOA	localhost. root.localhost. <span class="m">2</span> <span class="m">604800</span> <span class="m">86400</span> <span class="m">2419200</span> <span class="m">604800</span>
friendzoneportal.red.	604800	IN	AAAA	::1
friendzoneportal.red.	604800	IN	NS	localhost.
friendzoneportal.red.	604800	IN	A	127.0.0.1
admin.friendzoneportal.red. <span class="m">604800</span> IN	A	127.0.0.1
files.friendzoneportal.red. <span class="m">604800</span> IN	A	127.0.0.1
imports.friendzoneportal.red. <span class="m">604800</span> IN	A	127.0.0.1
vpn.friendzoneportal.red. <span class="m">604800</span> IN	A	127.0.0.1
friendzoneportal.red.	604800	IN	SOA	localhost. root.localhost. <span class="m">2</span> <span class="m">604800</span> <span class="m">86400</span> <span class="m">2419200</span> <span class="m">604800</span>
<span class="p">;;</span> Query time: <span class="m">28</span> msec
<span class="p">;;</span> SERVER: 10.10.10.123#53<span class="o">(</span>10.10.10.123<span class="o">)</span>
<span class="p">;;</span> WHEN: Thu Jul <span class="m">11</span> 15:17:22 BST <span class="m">2019</span>
<span class="p">;;</span> XFR size: <span class="m">9</span> records <span class="o">(</span>messages 1, bytes 309<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>admin.friendzoneportal.red</p>
</blockquote>
<p>Great! we have found the admin page. Lets update our /etc/hosts file to use these new domains. Unfortuantly you cannot use the servers dns service as they all resolve to localhost. Initially visiting admin.friendzoneportal.red just shows the same index page. So lets try https</p>
<p>Excellent we have a login form but when we log in we are just told</p>
<blockquote>
<p>Admin page is not developed yet !!! check for another one</p>
</blockquote>
<p>so more digging is required. Checking the SSL certificate from the website can see the issue is from a friendzone.red lets run dig again but this time zone transfer without the portal in the domain.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">root@kali:~/HTB/FriendZone# dig axfr friendzone.red @10.10.10.123

<span class="p">;</span> &lt;&lt;&gt;&gt; DiG 9.11.5-P4-3-Debian &lt;&lt;&gt;&gt; axfr friendzone.red @10.10.10.123
<span class="p">;;</span> global options: +cmd
friendzone.red.		604800	IN	SOA	localhost. root.localhost. <span class="m">2</span> <span class="m">604800</span> <span class="m">86400</span> <span class="m">2419200</span> <span class="m">604800</span>
friendzone.red.		604800	IN	AAAA	::1
friendzone.red.		604800	IN	NS	localhost.
friendzone.red.		604800	IN	A	127.0.0.1
administrator1.friendzone.red. <span class="m">604800</span> IN A	127.0.0.1
hr.friendzone.red.	604800	IN	A	127.0.0.1
uploads.friendzone.red.	604800	IN	A	127.0.0.1
friendzone.red.		604800	IN	SOA	localhost. root.localhost. <span class="m">2</span> <span class="m">604800</span> <span class="m">86400</span> <span class="m">2419200</span> <span class="m">604800</span>
<span class="p">;;</span> Query time: <span class="m">25</span> msec
<span class="p">;;</span> SERVER: 10.10.10.123#53<span class="o">(</span>10.10.10.123<span class="o">)</span>
<span class="p">;;</span> WHEN: Thu Jul <span class="m">11</span> 16:01:52 BST <span class="m">2019</span>
<span class="p">;;</span> XFR size: <span class="m">8</span> records <span class="o">(</span>messages 1, bytes 289<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Update /etc/hosts and visit <a href="https://administrator1.friendzone.red">https://administrator1.friendzone.red</a></p>
<figure>
    <img src="/img/te.png"
         alt="Admin Login"/> <figcaption>
            <p>/index.html</p>
        </figcaption>
</figure>

<p>Login using the username and password from creds.txt we got earlier from the samba share. On logging in we are told to visit /dashboard.php</p>
<h2 id="exploiting-the-lfi">Exploiting the LFI.</h2>
<h2 id="heading"></h2>
<h2 id="references">References</h2>
<ol>
<li><a href="https://youtu.be/JRPWFSzFaG0?t=75" target="_blank" rel="noopener noreffer">ippsec</a>
[2]:http://pentestmonkey.net/tools/web-shells/php-reverse-shell</li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" target="_blank" rel="noopener noreffer">php-reverse-shell</a></li>
</ol>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-06-26&nbsp;<a class="git-hash" href="https://github.com/Sam-Lane/commit/cbc947d2da406f641dc4e91aae55523c7ee26d35" target="_blank" title="commit by Sam Lane(samuel.lane@hotmail.com) cbc947d2da406f641dc4e91aae55523c7ee26d35: theme change">
                                    <i class="fas fa-hashtag fa-fw"></i>cbc947d</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/friendzone/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/hackthebox/">HackTheBox</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/hello-world/" class="prev" rel="prev" title="&#34;H3110_W0r1d&#34;"><i class="fas fa-angle-left fa-fw"></i>&#34;H3110_W0r1d&#34;</a>
            <a href="/hashcat-gen-passwords/" class="next" rel="next" title="Using Hashcat and a bit of Bash to generate password lists">Using Hashcat and a bit of Bash to generate password lists<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
